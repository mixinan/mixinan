<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>饺子联盟</title>
<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
<script type="text/javascript" src="js/cookie_util.js"></script>
<script type="text/javascript" src="js/const.js"></script>
<script type="text/javascript" src="js/blog.js"></script>
</head>
<body>
	<span id="user_name">user name</span>
	<h1>欢迎来到 饺子联盟 官网</h1>
	
	<p>
		<input id="blogText" placeholder="请输入blogText" />
		<button id="bt_send">发送</button>
	</p>
	
	<ul id="blog_list">
		
	</ul>
	
	<script>
	$(function(){
		var $list = $("#blog_list");
		
		//获取用户信息
		var userName = getCookie("userName");
		var userId = getCookie("userId");
		//alert("id "+userId+" name "+userName);
		
		//在顶部显示用户名
		$("#user_name").html(userName);
		
		/*打开页面，加载所有blog，此方法封装在（blog.js）*/
		getAllBlogs();
		
		
		
		//点击按钮，发送内容到数据库
		$("#bt_send").click(function(){
			var $input = $("#blogText");
			var blogText = $input.val().trim();
			console.log(blogText);
			
			$.ajax({
				type:"post",
				url:path+"/blog/addblog.do",
				data:{"userId":3,"blogText":blogText},
				dataType:"json",
				success:function(result){
					console.log(result.status);
					console.log(result.msg);
					//console.log(result.data);
					//发送完毕后，清空输入框内容
					$input.val("");
					//getAllBlogs();
					$list.prepend($("<li>"+blogText+"</li>"));
				},
				error:function(){
					console.log(result.status);
					console.log(result.msg);
					console.log(result.data);
				}
			});
			
		});
		
		
		
		
		
		
		
	});
		
	</script>
</body>
</html>